#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
인기 찬송가 30개 성경구절 매핑
가사 키워드 분석 기반
"""

# 고난주간/십자가 (7개)
hymn_refs = {
    # 가시 면류관, 십자가
    153: "요한복음 19:2",  # 가시관을 엮어 머리에 씌우고
    156: "요한복음 19:2",  # 머리에 가시관 붉은 피 흐르는

    # 죄 씻음, 보혈
    252: "요한1서 1:7",    # 예수의 피가 우리를 모든 죄에서 깨끗하게
    254: "히브리서 9:14",  # 그리스도의 피가 우리 양심을 정결하게
    255: "이사야 1:18",    # 너희 죄가 주홍같이 붉을지라도 눈과 같이 희어질 것이요

    # 죄에서 자유, 십자가
    268: "요한복음 8:36",  # 아들이 너희를 자유롭게 하면 너희가 참으로 자유로우리라
    269: "갈라디아서 2:20", # 나는 그리스도와 함께 십자가에 못 박혔나니

    # 구원/은혜 (5개)
    234: "누가복음 2:11",  # 오늘 다윗의 동네에 너희를 위하여 구주가 나셨으니
    256: "이사야 53:5-6", # 그가 찔림은 우리의 허물 때문이요
    259: "에베소서 1:7",  # 그의 피로 말미암아 구속 곧 죄 사함을 받았으니
    262: "디모데전서 1:15", # 그리스도 예수께서 죄인을 구원하시려고 세상에 임하셨다
    298: "로마서 3:25",   # 이 예수를 믿음으로 말미암아 그의 피로써 화목제물로 삼으셨으니

    # 위로/평안 (6개)
    371: "마가복음 4:39", # 바람을 꾸짖어 이르시되 잠잠하라 고요하라
    373: "시편 107:29-30", # 광풍을 고요하게 하사 물결을 잔잔하게 하시는도다
    389: "마태복음 11:28", # 수고하고 무거운 짐 진 자들아 다 내게로 오라
    400: "이사야 43:2",   # 네가 물 가운데로 지날 때에 내가 너와 함께 할 것이라
    410: "시편 40:3",     # 새 노래 곧 우리 하나님께 올릴 찬송을 내 입에 두셨으니
    416: "베드로전서 5:7", # 너희 염려를 다 주께 맡기라

    # 헌신/봉사 (5개)
    308: "시편 23:6",     # 내가 여호와의 집에 영원히 살리로다
    341: "마태복음 16:24", # 누구든지 나를 따라오려거든 자기를 부인하고 자기 십자가를 지고
    343: "마태복음 26:41", # 시험에 들지 않게 깨어 기도하라
    357: "에베소서 6:10", # 주 안에서와 그 힘의 능력으로 강건하여지고
    448: "요한복음 12:26", # 사람이 나를 섬기려면 나를 따르라

    # 찬양/경배 (4개)
    88: "시편 42:1-2",    # 하나님이여 사슴이 시냇물을 찾기에 갈급함 같이
    98: "요한계시록 22:20", # 주 예수여 오시옵소서
    563: "요한1서 4:19",  # 우리가 사랑함은 그가 먼저 우리를 사랑하셨음이라
    565: "요한복음 6:37", # 내게 오는 자는 내가 결코 내쫓지 아니하리라

    # 특별 절기 (3개)
    105: "이사야 9:6",    # 이는 한 아기가 우리에게 났고
    553: "애가 3:22-23", # 여호와의 인자하심이 무궁하시므로 우리가 진멸되지 아니함이니이다
    587: "시편 100:4",   # 감사함으로 그의 문에 들어가며
}

# SQL 생성
output_file = '/workspace/bibleai/migrations/009_popular_hymns_bible_references.sql'

with open(output_file, 'w', encoding='utf-8') as f:
    f.write("-- 인기 찬송가 30개 성경구절 업데이트\n")
    f.write("-- 가사 분석 기반으로 적합한 성경구절 매핑\n\n")

    # 카테고리별로 정리
    categories = [
        ("고난주간/십자가", [153, 156, 252, 254, 255, 268, 269]),
        ("구원/은혜", [234, 256, 259, 262, 298]),
        ("위로/평안", [371, 373, 389, 400, 410, 416]),
        ("헌신/봉사", [308, 341, 343, 357, 448]),
        ("찬양/경배", [88, 98, 563, 565]),
        ("특별 절기", [105, 553, 587]),
    ]

    for category, numbers in categories:
        f.write(f"-- {category}\n")
        for num in numbers:
            ref = hymn_refs[num]
            # PostgreSQL에서 작은따옴표 이스케이프
            escaped_ref = ref.replace("'", "''")
            f.write(f"UPDATE hymns SET bible_reference = '{escaped_ref}' WHERE number = {num};\n")
        f.write("\n")

print(f"✅ SQL 마이그레이션 파일 생성 완료")
print(f"   📁 파일: {output_file}")
print(f"   📊 총 {len(hymn_refs)}개 UPDATE 문 생성")
print()
print("📋 성경구절 매핑 요약:")
for num in sorted(hymn_refs.keys()):
    print(f"   {num}번 → {hymn_refs[num]}")
