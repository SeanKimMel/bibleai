# Changelog

블로그 발행 시스템 변경 사항

---

## [2025-10-08] 완전 자동화 및 찬송가 번호 검증 시스템 🚀

### 🚀 완전 자동화 구현
- **키워드만 입력하면 자동 발행**: 개발 Claude에게 키워드만 말하면 전체 프로세스 자동 처리
  - 데이터 수집 → 찬송가 번호 검증 → 비디오 검색 → 블로그 작성 → 발행
- **별도 세션 불필요**: 더 이상 새 Claude 창을 열 필요 없음

### 🔍 찬송가 번호 검증 시스템
- **문제 발견**: DB 찬송가 번호가 부정확함 (예: 528장이 320장으로 잘못 매핑)
- **해결책**: 웹 검색으로 실제 번호를 항상 확인
  - "새찬송가 [번호]장 제목" 검색
  - 제목과 번호 일치 여부 확인
  - 불일치 시 정확한 번호로 자동 수정

### ✨ 시즌별 찬송가 필터링
- **성탄 찬송가** (주제: "성탄"): 12월에만 사용
- **부활절 찬송가** (주제: "부활"): 3-4월에만 사용
- 시즌 외 찬송가 자동 제외 또는 대체

### 📝 문서 업데이트
- ✅ `QUICK_PUBLISH.md` 신규 작성 - 빠른 발행 완전 가이드
- ✅ `CLAUDE_PROMPT.md` 업데이트 - 찬송가 번호 웹 검증 절차 추가
- ✅ `README.md` 업데이트 - 초간단 방식(키워드만 입력) 가이드 추가

### 🐛 찬송가 DB 오류 사례
- **오류**: "예수가 우리를 부르는 소리" = 통일 289장 → 새찬송가 320장 (DB)
- **정확**: "예수가 우리를 부르는 소리" = 통일 318장 → 새찬송가 528장 (실제)
- **차이**: 통일 29장, 새찬송가 208장 차이!

### 📊 발행 사례
**블로그 ID 15**: "일상으로 돌아가는 당신에게 필요한 진정한 평안"
- 키워드: 평안
- 성경: 사무엘하 3장
- 찬송가: 528장 "예수가 우리를 부르는 소리" (DB 320장 → 웹 검증으로 528장 수정)
- 비디오 ID: gcig50PyUEk
- 발행: ✅ 성공

### 📊 품질 검증 시스템
- ✅ `BLOG_VALIDATION_GUIDE.md` 신규 작성 - 블로그 품질 평가 기준 문서화
  - 8가지 평가 항목 (총 100점)
  - 각 항목별 체크리스트
  - 자동 검증 스크립트 개발 가이드
  - Claude 프롬프트 템플릿 포함

### 향후 계획
- [ ] 찬송가 데이터베이스 전면 재구축 (정확한 소스 사용)
- [ ] 블로그 품질 자동 검증 스크립트 구현 (`validate_blog.sh`)
- [ ] 블로그 UPDATE API 추가 (현재는 재발행만 가능)
- [ ] GitHub Actions 품질 자동 검증 통합

---

## [2025-10-07] 자동 비디오 검증 시스템 구축 🎉

### 새로운 기능

#### 1. 완전 자동 비디오 검색 및 검증
- **파일**: `scripts/auto_find_hymn_video.sh`
- **기능**:
  - yt-dlp를 사용한 YouTube 검색
  - 검색 결과에서 상위 10개 비디오 추출
  - oEmbed API로 임베드 가능 여부 자동 검증
  - 저작권 차단/계정 해지 비디오 자동 제외
  - 첫 번째 동작하는 비디오 ID 반환
- **사용법**:
  ```bash
  ./scripts/auto_find_hymn_video.sh "찬송가 200장 주 품에 품으소서"
  ```

#### 2. 비디오 ID 데이터베이스
- **파일**: `scripts/hymn_videos.json`
- **기능**: 검증된 비디오 ID 저장 및 재사용
- **구조**:
  ```json
  {
    "200": {
      "title": "주 품에 품으소서",
      "videoId": "XP8WsSZAx1o",
      "channel": "엘정",
      "verified": true,
      "notes": "자동 검증 완료"
    }
  }
  ```

#### 3. 여러 비디오 ID 일괄 테스트
- **파일**: `scripts/test_multiple_videos.sh`
- **기능**: 여러 비디오 ID를 한 번에 테스트하여 동작하는 것 찾기
- **사용법**:
  ```bash
  ./scripts/test_multiple_videos.sh VIDEO_ID1 VIDEO_ID2 VIDEO_ID3
  ```

### 기술 스택

- **yt-dlp**: YouTube 검색 및 비디오 정보 추출
- **YouTube oEmbed API**: 임베드 가능 여부 검증
- **bash + jq**: 자동화 스크립트

### 해결한 문제

❌ **이전 문제점**:
- 수동으로 찾은 비디오 ID가 저작권 차단
- 계정 해지된 채널의 비디오 사용
- 임베드 시 "이 동영상을 재생할 수 없음" 오류
- 매번 수동으로 테스트 필요

✅ **해결 방법**:
- 자동 검색 및 검증으로 완전 자동화
- 문제있는 비디오 자동 제외
- 검증된 비디오만 데이터베이스에 저장
- 한 번 검증하면 재사용 가능

### 문서 업데이트

- ✅ `CLAUDE_PROMPT.md` - 비디오 ID 찾기 방법 업데이트
- ✅ `WORKFLOW.md` - 자동 비디오 검색 단계 추가
- ✅ `README.md` - 새로운 기능 섹션 추가
- ✅ `scripts/AUTO_VIDEO_FINDER_GUIDE.md` - 상세 가이드 작성
- ✅ `scripts/HYMN_VIDEO_DATABASE_GUIDE.md` - 데이터베이스 가이드

### 성공 사례

**블로그 ID 13**: "하나님께서 주시는 참된 평안"
- 키워드: 평안
- 찬송가: 200장 "주 품에 품으소서"
- 비디오 ID: XP8WsSZAx1o (자동 검증 완료)
- 발행 상태: ✅ 성공

### 향후 계획

- [ ] 더 많은 찬송가 비디오 ID 데이터베이스 구축
- [ ] YouTube Data API v3 통합 (선택사항)
- [ ] 정기적인 비디오 ID 재검증 시스템
- [ ] 채널 화이트리스트 필터링

---

## [2025-10-06] 초기 시스템 구축

- API 기반 데이터 수집
- Claude 프롬프트 템플릿
- 블로그 발행 스크립트
- 수동 비디오 ID 검증
